

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Solid-Vacuum interface of a Lennard-Jones crystal with wells &mdash; SurFEC  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Solid-Liquid interface of a Lennard-Jones crystal in contact with a Lennard-Jones liquid with walls" href="example_SL_walls.html" />
    <link rel="prev" title="Examples" href="example.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> SurFEC
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="lammps.html">LAMMPS commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="example.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Solid-Vacuum interface of a Lennard-Jones crystal with wells</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1">Step 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2">Step 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-3">Step 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4">Step 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculation-of-the-sfe">Calculation of the SFE</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="example_SL_walls.html">Solid-Liquid interface of a Lennard-Jones crystal in contact with a Lennard-Jones liquid with walls</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SurFEC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="example.html">Examples</a> &raquo;</li>
        
      <li>Solid-Vacuum interface of a Lennard-Jones crystal with wells</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/example_SV_wells.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="solid-vacuum-interface-of-a-lennard-jones-crystal-with-wells">
<h1>Solid-Vacuum interface of a Lennard-Jones crystal with wells<a class="headerlink" href="#solid-vacuum-interface-of-a-lennard-jones-crystal-with-wells" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example requires few hours of computation time on 16 cores to generate a sensible output. However, you can run shorter simulations to acquaintance yourself with the code. To do this, change the input file variables <code class="docutils literal notranslate"><span class="pre">eqnts</span></code> and <code class="docutils literal notranslate"><span class="pre">nts</span></code> (equilibration and production number of time steps) to smaller values and/or reduce the number of points to move the walls (<a class="reference internal" href="#step-1"><span class="std std-doc">Step 1</span></a>, <a class="reference internal" href="#step-2"><span class="std std-doc">Step 2</span></a> or <a class="reference internal" href="#step-4"><span class="std std-doc">Step 4</span></a>) or switch off the interactions (<a class="reference internal" href="#step-3"><span class="std std-doc">Step 3</span></a>).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this section <code class="docutils literal notranslate"><span class="pre">/</span></code> is the package’s root folder.</p>
</div>
<p>In this example we will set up the cleaving calculation for the calculation of the SFE of a Lennard-Jones crystal in contact with vacuum.</p>
<p>The input files for the whole calculations are already given in the directory <code class="docutils literal notranslate"><span class="pre">/examples/lj_SV</span></code> but in this tutorial we will go through the writing of such files from scratch.</p>
<p>First of all, create a new folder <code class="docutils literal notranslate"><span class="pre">lj_SV</span></code> and step in it. Copy the folder <code class="docutils literal notranslate"><span class="pre">/example/lj_SV/utils/</span></code> in the folder <code class="docutils literal notranslate"><span class="pre">lj_SV</span></code> just created. The folder <code class="docutils literal notranslate"><span class="pre">/utils/</span></code> contains some simple programs and script that will be needed to analyze the results.</p>
<div class="section" id="step-1">
<h2>Step 1<a class="headerlink" href="#step-1" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Create a <code class="docutils literal notranslate"><span class="pre">step1</span></code> folder and enter it. Create the <code class="docutils literal notranslate"><span class="pre">out/</span></code>, <code class="docutils literal notranslate"><span class="pre">data/</span></code>, <code class="docutils literal notranslate"><span class="pre">restart/</span></code>, and <code class="docutils literal notranslate"><span class="pre">dump/</span></code> subfolders. Note that you can safely comment out the <code class="docutils literal notranslate"><span class="pre">dump</span></code> and <code class="docutils literal notranslate"><span class="pre">restart</span></code> lines of the input, since dump and restart files are not needed for the cleaving computation. In this case you don’t need to create the <code class="docutils literal notranslate"><span class="pre">restart/</span></code> and <code class="docutils literal notranslate"><span class="pre">dump/</span></code> folders.</p></li>
<li><p>Prepare the LAMMPS input file. Here we use <code class="docutils literal notranslate"><span class="pre">/examples/lj_S/bulk.in</span></code> file as a starting point. Copy it to the current folder, delete all the lines after the <code class="docutils literal notranslate"><span class="pre">f3</span></code> fix and change the temperature to 0.1 <code class="docutils literal notranslate"><span class="pre">variable</span> <span class="pre">Tsyst</span> <span class="pre">equal</span> <span class="pre">0.1</span></code>.</p></li>
<li><p>Prepare the starting configuration. Here we copy the <code class="docutils literal notranslate"><span class="pre">/examples/lj_systems/fcc111-T01.lmp</span></code> data file to the current folder. The file contains the starting configuration, a Lennard-Jones fcc crystal oriented along the direction (111) at the (reduced) temperature of 0.1. Edit the <code class="docutils literal notranslate"><span class="pre">bulk.in</span></code> input file so that the correct data file is read (<em>i.e.</em> change the <code class="docutils literal notranslate"><span class="pre">read_data</span> <span class="pre">fcc111-T1.lmp</span></code> line to <code class="docutils literal notranslate"><span class="pre">read_data</span> <span class="pre">fcc111-T01.lmp</span></code>).</p></li>
<li><p>Prepare a wells file. Here we will use the <code class="docutils literal notranslate"><span class="pre">/examples/lj_systems/fcc111-T01-wells.lmp</span></code> file, which should be copied to the current folder. The exact format of this file is given in the description of the appropriate fix.</p></li>
<li><p>Prepare a file containing the variation of the strength of the wells. This file contains a sequence of increasing consecutive numbers in the interval <span class="math notranslate nohighlight">\([0,1]\)</span> (extremes included). Here is a (truncated) example:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.0</span>
<span class="mf">0.001</span>
<span class="mf">0.002</span>
<span class="mf">0.05</span>
<span class="mf">0.1</span>
<span class="o">...</span>
<span class="mf">0.998</span>
<span class="mf">0.999</span>
<span class="mf">1.0</span>
</pre></div>
</div>
<p>Note:</p>
<ul class="simple">
<li><p>The file must start at 0 and end at 1.</p></li>
<li><p>There is no internal control in the code that checks that the boundaries are correct</p></li>
</ul>
<p>Here we will be using the <code class="docutils literal notranslate"><span class="pre">/examples/lj_SV/step1/lambda_wells.dat</span></code> file, so make sure to copy it to the current folder.</p>
<p><img alt="Step-1" src="_images/wells-S1.png" /></p>
<ol class="arabic simple" start="6">
<li><p>The wells in the system are introduced using the new fix <code class="docutils literal notranslate"><span class="pre">wellPforce</span></code>:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>fix f2 all wellPforce ${dw} ${rw} ${expp} ${lambda} file fcc111-T01-wells.lmp 
</pre></div>
</div>
<p>where the explanation of the different parameters is given in the <a class="reference internal" href="fix_well.html"><span class="doc std std-doc">description</span></a> of the fix. In the wells version of the cleaving model, the wells are introduced by switching the parameter lambda from 0 (no interactions between atoms and wells) and 1 (full interactions between atoms and wells). LAMMPS allows the creation of an input file which can perform several runs in a row by changing the parameter between the different runs. The relevant code that should be added to <code class="docutils literal notranslate"><span class="pre">bulk.in</span></code> is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>variable Nevery  equal 100
variable Nrepeat equal 5
variable Nfreq   equal 500

variable lam file lambda_wells.dat
variable i     equal 1
variable dw    equal 6.0
variable a0    equal exp(1/3*ln(4/1.05604))
variable rw    equal sqrt(2)*${a0}/4.0*1.2
variable expp  equal 3.0

label here
variable    lambda equal ${lam}

fix f2 all wellPforce ${dw} ${rw} ${expp} ${lambda} file fcc111-T01-wells.lmp 

print       &quot;Well depth ${lambda}&quot;
run ${eqnts}

fix  f5 all ave/time ${Nevery} ${Nrepeat} ${Nfreq} c_thermo_temp c_thermo_pe f_f2 v_lambda file  out/ave.F.${i}.out

run ${nts}

unfix f5
unfix f2 

write_data data/Fstep1.${i}.data nocoeff
variable    ii equal ${i}+1
variable    i  equal ${ii}
next lam
jump SELF here
</pre></div>
</div>
<p>To keep the main directory clean from all the output files generated during the run, we print those files in the <code class="docutils literal notranslate"><span class="pre">out</span></code> and <code class="docutils literal notranslate"><span class="pre">data</span></code> folders.</p>
<p>We refer to the <a class="reference external" href="https://docs.lammps.org/jump.html">LAMMPS documentation</a> for the use of the <code class="docutils literal notranslate"><span class="pre">jump</span></code> command to create a loop. Each iteration of the loop produces the following files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Fstep1.${i}.data</span></code>: data file containing the last configuration of the i-th iteration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ave.F.${i}.out</span></code>: File which contains a summary of the properties of the system, including the work (<code class="docutils literal notranslate"><span class="pre">f_f2</span></code>)</p></li>
</ul>
<ol class="arabic simple" start="7">
<li><p>Launch the simulation.</p></li>
</ol>
</div>
<div class="section" id="step-2">
<h2>Step 2<a class="headerlink" href="#step-2" title="Permalink to this headline">¶</a></h2>
<p>This step for this particular system (a crystal in coexistence with vacuum) is empty, so we can directly go to <a class="reference internal" href="#step-3"><span class="std std-doc">Step 3</span></a>.</p>
</div>
<div class="section" id="step-3">
<h2>Step 3<a class="headerlink" href="#step-3" title="Permalink to this headline">¶</a></h2>
<p><img alt="Step-3" src="_images/wells-S3.png" /></p>
<p>In the third step we switch off the interactions between the two sides of the cleaving wall.</p>
<ol class="arabic simple">
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">step3</span></code> folder and enter it. Create the <code class="docutils literal notranslate"><span class="pre">out/</span></code>, <code class="docutils literal notranslate"><span class="pre">data/</span></code>, <code class="docutils literal notranslate"><span class="pre">dat/</span></code>, <code class="docutils literal notranslate"><span class="pre">restart/</span></code>, and <code class="docutils literal notranslate"><span class="pre">dump/</span></code> subfolders (where the latter two can be omitted if the related commands in the LAMMPS script file are commented). The <code class="docutils literal notranslate"><span class="pre">dat/</span></code> folder will contain the output of this step.</p></li>
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">fcc111-T01-wells.lmp</span></code> and the last <code class="docutils literal notranslate"><span class="pre">data/Fstep1.*.data</span></code> file from the <a class="reference internal" href="#step-1"><span class="std std-doc">Step 1</span></a> folder.</p></li>
<li><p>Prepare a new LAMMPS input file. We again use the <code class="docutils literal notranslate"><span class="pre">/examples/lj_S/bulk.in</span></code> file as a starting point. Copy it to the current folder, delete all the lines after the <code class="docutils literal notranslate"><span class="pre">f3</span></code> fix and change the temperature to 0.1 <code class="docutils literal notranslate"><span class="pre">variable</span> <span class="pre">Tsyst</span> <span class="pre">equal</span> <span class="pre">0.1</span></code> and change the name of the data file to match the file copied in sub-step 2.</p></li>
<li><p>The switching off is implemented directly in the definition of the pair interactions. We therefore need to change the pair interaction in the LAMMPS script file (section <em>Interactions</em>) to the new defined type</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pair_style lj/BGcleavpbc ${cutoff1} ${cutoff2} z
</pre></div>
</div>
<p>All the parameters (<code class="docutils literal notranslate"><span class="pre">cutoff1</span></code>, <code class="docutils literal notranslate"><span class="pre">cutoff2</span></code>, <code class="docutils literal notranslate"><span class="pre">epsilon</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma</span></code>) are identical to those used in <a class="reference internal" href="#step-1"><span class="std std-doc">Step 1</span></a>. Note that there is a third parameter in this <code class="docutils literal notranslate"><span class="pre">pair_style</span></code>, the direction normal to the cleaving plane, which is <code class="docutils literal notranslate"><span class="pre">z</span></code> in this case.</p>
<ol class="arabic simple" start="5">
<li><p>Add the command for the wells, together with the definition of the variables that sets the parameters specifying the wells characteristics:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>variable dw    equal 6.0
variable a0    equal exp(1/3*ln(4/1.05604))
variable rw    equal sqrt(2)*${a0}/4.0*1.2
variable expp  equal 3.0

fix f2 all wellPforce ${dw} ${rw} ${expp} 1.0 file fcc111-T01-wells.lmp
</pre></div>
</div>
<p>In this step the strenght of the wells remains constant, therefore we replace <code class="docutils literal notranslate"><span class="pre">${lambda}</span></code> with 1.</p>
<ol class="arabic simple" start="6">
<li><p>Create a file (called <code class="docutils literal notranslate"><span class="pre">zdir.dat</span></code>) for the switching off of the interactions across the cleaving plane (or copy <code class="docutils literal notranslate"><span class="pre">/examples/LJ_SV/step3/zdir.dat</span></code>). The file should contain a list of values that specify how much the box will be moved away from its periodic images along the normal to the cleaving plane (<code class="docutils literal notranslate"><span class="pre">z</span></code> in our case). The file must start with zero, which is the first point of the switching. Here is an example:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.0</span>
<span class="mf">0.001</span>
<span class="mf">0.002</span>
<span class="mf">0.05</span>
<span class="mf">0.1</span>
<span class="o">...</span>
<span class="mf">2.0</span>
<span class="mf">2.2</span>
<span class="mf">2.4</span>
<span class="mf">2.8</span>
<span class="mf">3.2</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Note: the upper boundary should be large enough so that, when the box has moved this much, there are no more interactions between the box and its periodic images. A value of 2.6 is usually enough.</p>
<ol class="arabic simple" start="7">
<li><p>The work needed to switch off the interactions (described in the next point) is calculated by adding the line <code class="docutils literal notranslate"><span class="pre">compute</span> <span class="pre">1</span> <span class="pre">all</span> <span class="pre">cleavpairs</span> <span class="pre">lj/BGcleavpbc</span> <span class="pre">norm</span> <span class="pre">2</span> <span class="pre">z</span></code> to end of the LAMMPS script file. The meaning of the parameters is reported in the <a class="reference internal" href="compute_pcleav.html"><span class="doc std std-doc">description</span></a> of this compute style.</p></li>
<li><p>The actual switching off is obtained through another loop which increases the size of the box. Since the atoms are kept in place by the cleaving potential, increasing the size of the box creates a vacuum space. When the vacuum space is larger than <code class="docutils literal notranslate"><span class="pre">cutoff2</span></code> than the box and its image across the cleaving wall do not interact anymore. Add the following loop to the end of the LAMMPS script file:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>variable Nevery  equal 100
variable Nrepeat equal 5
variable Nfreq   equal 500

variable initzhi equal $(zhi)
variable initzlo equal $(zlo)
variable zc file zdir.dat
variable i equal 1

label here
variable dhi equal ${zc}
variable newzhi equal ${dhi}+${initzhi}
variable newzlo equal ${initzlo}

print       &quot;Forward Interaction ${i}: ${zc} &quot;
print       &quot; ${initzhi} ${dhi} zhi &quot;

change_box all z final ${newzlo}  ${newzhi}

print       &quot;B ${initzhi} ${dhi} zhi &quot;

run   ${eqnts}

fix   f6 all ave/time ${Nevery} ${Nrepeat} ${Nfreq}  c_1[*] file dat/inters3.${i}.dat mode vector
fix   f7 all ave/time ${Nevery} ${Nrepeat} ${Nfreq} c_thermo_temp c_thermo_pe f_f2 v_dhi file  out/ave.F.${i}.out

run   ${nts}

unfix f6
unfix f7

write_data  data/Fstep3.${i}.data  nocoeff
variable    ii equal ${i}+1
variable    i  equal ${ii}
next zc
jump SELF here
</pre></div>
</div>
<p>We refer to the <a class="reference external" href="https://docs.lammps.org/change_box.html">LAMMPS documentation</a> for the exact explanation of the <code class="docutils literal notranslate"><span class="pre">change_box</span></code> command.</p>
<ol class="arabic simple" start="9">
<li><p>Launch the simulation.</p></li>
</ol>
</div>
<div class="section" id="step-4">
<h2>Step 4<a class="headerlink" href="#step-4" title="Permalink to this headline">¶</a></h2>
<p><img alt="Step-4" src="_images/wells-S4.png" /></p>
<p>In the last step we remove the wells leaving free the newly created interfaces.</p>
<ol class="arabic simple">
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">step4</span></code> folder and enter it. Create the <code class="docutils literal notranslate"><span class="pre">out/</span></code>, <code class="docutils literal notranslate"><span class="pre">data/</span></code>, <code class="docutils literal notranslate"><span class="pre">restart/</span></code>, and <code class="docutils literal notranslate"><span class="pre">dump/</span></code> subfolders (where the latter two can be omitted if the related commands in the LAMMPS script file are commented). The <code class="docutils literal notranslate"><span class="pre">out/</span></code> folder will contain the output of this step.</p></li>
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">fcc111-T01-wells.lmp</span></code> and the last <code class="docutils literal notranslate"><span class="pre">data/Fstep3.*.data</span></code> file from the <a class="reference internal" href="#step-3"><span class="std std-doc">Step 3</span></a> folder.</p></li>
<li><p>Prepare a new LAMMPS input file. We again use the <code class="docutils literal notranslate"><span class="pre">/examples/lj_S/bulk.in</span></code> file as a starting point. Copy it to the current folder, delete all the lines after the <code class="docutils literal notranslate"><span class="pre">f3</span></code> fix and change the temperature to 0.1 <code class="docutils literal notranslate"><span class="pre">variable</span> <span class="pre">Tsyst</span> <span class="pre">equal</span> <span class="pre">0.1</span></code> and change the name of the data file to match the file copied in sub-step 2.</p></li>
<li><p>Prepare a file containing the variation of the strength of the wells. This file contains a sequence of increasing consecutive numbers in the interval <span class="math notranslate nohighlight">\([0,1]\)</span> (extremes included). Here is a (truncated) example:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.0</span>
<span class="mf">0.99</span>
<span class="mf">0.98</span>
<span class="o">...</span>
<span class="mf">0.02</span>
<span class="mf">0.01</span>
<span class="mf">0.0</span>
</pre></div>
</div>
<p>Note:</p>
<ul class="simple">
<li><p>The file must start at 1 and end at 0.</p></li>
<li><p>There is no internal control in the code that checks that the boundaries are correct.</p></li>
<li><p>The values does not need to be the same (in reverse order) of those used in <a class="reference internal" href="#step-1"><span class="std std-doc">Step 1</span></a>.</p></li>
</ul>
<p>Here we will be using the <code class="docutils literal notranslate"><span class="pre">/examples/lj_SV/step4/rev_lambda_wells.dat</span></code> file, so make sure to copy it to the current folder.</p>
<ol class="arabic simple" start="5">
<li><p>The loop in <a class="reference internal" href="#step-4"><span class="std std-doc">Step 4</span></a> in analogous to the loop in <a class="reference internal" href="#step-1"><span class="std std-doc">Step 1</span></a> run backwards</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>variable Nevery  equal 100
variable Nrepeat equal 5
variable Nfreq   equal 500

variable lam   file rev_lambda_wells.dat
variable dw    equal 6.0
variable a0    equal exp(1/3*ln(4/1.05604))
variable rw    equal sqrt(2)*${a0}/4.0*1.2
variable expp  equal 3.0
variable i     equal 1

label here
variable    lambda equal ${lam}

fix f2 all wellPforce ${dw} ${rw} ${expp} ${lambda} file fcc111-T01-wells.lmp
variable totW   equal &quot;f_f2&quot;

print       &quot;Well depth ${lambda}&quot;

run   ${eqnts}

fix  f6 all ave/time  ${Nevery} ${Nrepeat} ${Nfreq}  c_thermo_temp c_thermo_pe v_totW v_lambda f_f2   file out/ave.F.$i.out

run  ${nts}

unfix f2
unfix f6
write_data data/Fstep4.$i.data nocoeff
variable    ii equal $i+1
variable    i  equal ${ii}
next lam
jump SELF here
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Launch the simulation.</p></li>
</ol>
</div>
<div class="section" id="calculation-of-the-sfe">
<h2>Calculation of the SFE<a class="headerlink" href="#calculation-of-the-sfe" title="Permalink to this headline">¶</a></h2>
<p>The SFE is obtained by summing the work performed in the <a class="reference internal" href="#step-1"><span class="std std-doc">Step 1</span></a>, <a class="reference internal" href="#step-3"><span class="std std-doc">Step 3</span></a>, <a class="reference internal" href="#step-4"><span class="std std-doc">Step 4</span></a>. The work is calculated by using the results produced in each step. The folder <code class="docutils literal notranslate"><span class="pre">/utils/</span></code> contains some small programs for the post-processing.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">work.sh</span></code>: bash script to calculate the average of the relevant properties for each step of the thermodynamic integration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c3cryst.f90</span></code>: fortran program to extract the value of the interactions calculated in  Step 3. It must be compiled by running the command <code class="docutils literal notranslate"><span class="pre">gfortran</span> <span class="pre">c3cryst.f90</span></code> from within the <code class="docutils literal notranslate"><span class="pre">/utils/</span></code> folder</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calcSFE.m</span></code>: Matlab script to perform the integration of each curve</p></li>
</ul>
<p>Before analyzing the calculations, let’s create a folder ‘/results/’ at the same level of the folders <code class="docutils literal notranslate"><span class="pre">./step1/</span></code>, <code class="docutils literal notranslate"><span class="pre">./step3</span></code>, <code class="docutils literal notranslate"><span class="pre">./step4</span></code>. Here, we will copy the results for each step.</p>
<ol class="arabic simple">
<li><p>The files <code class="docutils literal notranslate"><span class="pre">.out</span></code> generated in <a class="reference internal" href="#step-1"><span class="std std-doc">Step 1</span></a> contains the quantity <code class="docutils literal notranslate"><span class="pre">f_f2</span></code>, which is the work performed. An average of that quantity for each lambda gives the variation of the energy in Step1. The integration of the results quantity over lambda gives the total work in <a class="reference internal" href="#step-1"><span class="std std-doc">Step 1</span></a>. In order to calculate the work performed in Step 1:</p>
<ol class="arabic simple">
<li><p>Enter in the dir <code class="docutils literal notranslate"><span class="pre">./step1/out/</span></code></p></li>
<li><p>Call the script <code class="docutils literal notranslate"><span class="pre">../../utils/work.sh</span> <span class="pre">F</span></code></p></li>
<li><p>Copy the file <code class="docutils literal notranslate"><span class="pre">F-work.dat</span></code> in the folder <code class="docutils literal notranslate"><span class="pre">./results/</span></code> by changing its name to <code class="docutils literal notranslate"><span class="pre">step1_work.dat</span></code></p></li>
</ol>
</li>
</ol>
<p>The profile of the work obtained as function of <span class="math notranslate nohighlight">\(\lambda\)</span> is represented in the next figure.
<img alt="Step-1 profile" src="_images/ws1.png" /></p>
<ol class="arabic simple" start="2">
<li><p>The files <code class="docutils literal notranslate"><span class="pre">.dat</span></code> generated in <a class="reference internal" href="#step-3"><span class="std std-doc">Step 3</span></a> contains the interactions <em>switched-off</em> during the <a class="reference internal" href="#step-3"><span class="std std-doc">Step 3</span></a>. By averaging these values for each value of zw we obtain the variation of the energy, and the integration of the results over zw gives the total work done in <a class="reference internal" href="#step-3"><span class="std std-doc">Step 3</span></a>.</p></li>
</ol>
<p>In order to calculate the work performed in Step 3:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. Enter in the dir `./step3/out/`
2. Call the program `../../utils/a.out`
3. Call the script `../../utils/work.sh F`
4. Copy the file `F-work.dat` in the folder `./results/` by changing its name to `step3_work.dat`
</pre></div>
</div>
<p>The profile of the work obtained as function of <span class="math notranslate nohighlight">\(z\)</span> is represented in the next figure.
<img alt="Step-3 profile" src="_images/ws3.png" /></p>
<ol class="arabic simple" start="3">
<li><p><a class="reference internal" href="#step-4"><span class="std std-doc">Step 4</span></a> is analogous to <a class="reference internal" href="#step-1"><span class="std std-doc">Step 1</span></a>. Remember to change the name of the file obtained to <code class="docutils literal notranslate"><span class="pre">step4_work.dat</span></code></p></li>
</ol>
<p>The profile of the work obtained as function of <span class="math notranslate nohighlight">\(\lambda\)</span> is represented in the next figure.
<img alt="Step-4 profile" src="_images/ws4.png" /></p>
<ol class="arabic simple" start="4">
<li><p>After the profile of the work in the three steps is obtained, we can calculate the SFE by integrating the three curves. Enter in the dir <code class="docutils literal notranslate"><span class="pre">/results</span></code>, copy the Matlab script  <code class="docutils literal notranslate"><span class="pre">/utils/calcSFE.m</span></code> and run it in Matlab from this folder. The final value of the SFE is: <span class="math notranslate nohighlight">\(2.095\pm 0.007\)</span> in units of <span class="math notranslate nohighlight">\(\epsilon\sigma^{-2}\)</span></p></li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="example_SL_walls.html" class="btn btn-neutral float-right" title="Solid-Liquid interface of a Lennard-Jones crystal in contact with a Lennard-Jones liquid with walls" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="example.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2022, Nicodemo Di Pasquale and Lorenzo Rovigatti

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>